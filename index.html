<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¤ã‚±é… - ãŠé£Ÿäº‹ã‚’é¸ã¶</title>
    
    <!-- PWAå¯¾å¿œ -->
    <meta name="description" content="æ–™ç†ã‚‚ã€ã¨ãã‚ãã‚‚ã€ä¸€ç·’ã«å±Šã‘ã¾ã™ã€‚ã‚¤ã‚±ãƒ¡ãƒ³é…é”å“¡ã‚’æŒ‡åã§ãã‚‹æ–°æ„Ÿè¦šãƒ‡ãƒªãƒãƒªãƒ¼ã‚¢ãƒ—ãƒªã€‚">
    <meta name="theme-color" content="#ff6b9d">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="ã‚¤ã‚±é…">
    <link rel="manifest" href="./manifest.json">
    <link rel="apple-touch-icon" href="./icons/icon-192x192.png">
    
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="header-left">
                    <h1 class="logo">ğŸš´ ã‚¤ã‚±é… Ikehai</h1>
                    <p class="tagline">ã¨ãã‚ãé…é”ã€å±Šã‘ã¾ã™</p>
                </div>
                <div class="header-right">
                    <a href="subscription.html" class="shop-link">ğŸ“¦ å®šæœŸä¾¿</a>
                    <a href="shop.html" class="shop-link">ğŸ›ï¸ ã‚·ãƒ§ãƒƒãƒ—</a>
                    <div id="membershipStatus" class="membership-status">
                        <a href="premium.html" class="premium-link">ğŸ’ ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡</a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <main class="main-content">
        <div class="container">
            <section class="intro-section">
                <h2>ãŠå¥½ã¿ã®æ–™ç†ã‚’é¸ã‚“ã§ãã ã•ã„</h2>
                <p>é¸ã‚“ã å¾Œã¯ã€ã‚ãªãŸå°‚å±ã®ã‚¤ã‚±ãƒ¡ãƒ³é…é”å“¡ã‚’æŒ‡åã§ãã¾ã™âœ¨</p>
                <p class="intro-highlight">ğŸ’• æ–™ç†ã‚‚ã€ã¨ãã‚ãã‚‚ã€ä¸€ç·’ã«å±Šã‘ã¾ã™</p>
            </section>

            <!-- ãƒãƒŠãƒ¼åºƒå‘Šã‚¨ãƒªã‚¢ -->
            <div class="ad-banner-container" id="adBanner">
                <!-- JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
            </div>

            <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ»ã‚½ãƒ¼ãƒˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
            <div class="filter-sort-container">
                <!-- ã‚«ãƒ†ã‚´ãƒªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
                <div class="filter-section">
                    <label class="filter-label">ğŸ½ï¸ ã‚«ãƒ†ã‚´ãƒª:</label>
                    <div class="filter-buttons">
                        <button class="filter-btn active" onclick="filterByCategory('all', this)">ã™ã¹ã¦</button>
                        <button class="filter-btn" onclick="filterByCategory('æ´‹é£Ÿ', this)">æ´‹é£Ÿ</button>
                        <button class="filter-btn" onclick="filterByCategory('å’Œé£Ÿ', this)">å’Œé£Ÿ</button>
                        <button class="filter-btn" onclick="filterByCategory('ä¸­è¯', this)">ä¸­è¯</button>
                        <button class="filter-btn" onclick="filterByCategory('ã‚¨ã‚¹ãƒ‹ãƒƒã‚¯', this)">ã‚¨ã‚¹ãƒ‹ãƒƒã‚¯</button>
                        <button class="filter-btn" onclick="filterByCategory('ãƒ‡ã‚¶ãƒ¼ãƒˆ', this)">ãƒ‡ã‚¶ãƒ¼ãƒˆ</button>
                    </div>
                </div>

                <!-- ã‚½ãƒ¼ãƒˆ -->
                <div class="sort-section">
                    <label class="sort-label">ğŸ“Š ä¸¦ã³æ›¿ãˆ:</label>
                    <select class="sort-select" onchange="sortMenu(this.value)">
                        <option value="default">ãŠã™ã™ã‚é †</option>
                        <option value="price-asc">ä¾¡æ ¼ãŒå®‰ã„é †</option>
                        <option value="price-desc">ä¾¡æ ¼ãŒé«˜ã„é †</option>
                        <option value="popular">äººæ°—é †</option>
                    </select>
                </div>
            </div>

            <!-- ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚«ãƒ¼ãƒ‰è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
            <div id="menuGrid" class="card-grid">
                <!-- JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
                <div class="loading">èª­ã¿è¾¼ã¿ä¸­...</div>
            </div>
        </div>
    </main>

    <!-- ãƒ•ãƒƒã‚¿ãƒ¼ -->
    <footer class="footer">
        <p>&copy; 2025 Ikehai - All Rights Reserved</p>
    </footer>

    <script src="js/data.js"></script>
    <script src="js/script.js"></script>
    <script src="js/pwa-installer.js"></script>
    <script>
        let allMenuData = [];
        let currentCategory = 'all';
        let currentSort = 'default';

        // ãƒãƒŠãƒ¼åºƒå‘Šã‚’è¡¨ç¤º
        function displayAdBanner() {
            const banners = getRandomBanners(1);
            const banner = banners[0];
            
            const adBannerContainer = document.getElementById('adBanner');
            adBannerContainer.innerHTML = `
                <div class="ad-banner">
                    <span class="ad-label">ã‚¹ãƒãƒ³ã‚µãƒ¼</span>
                    <div class="ad-content">
                        <img src="${banner.image}" alt="${banner.title}" class="ad-image">
                        <div class="ad-text">
                            <h3 class="ad-title">${banner.title}</h3>
                            <p class="ad-description">${banner.description}</p>
                            <p class="ad-sponsor">æä¾›: ${banner.sponsor}</p>
                        </div>
                    </div>
                </div>
            `;
        }

        // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚“ã§è¡¨ç¤º
        function loadMenu() {
            try {
                // data.jsã‹ã‚‰ç›´æ¥ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
                allMenuData = getMenuData();
                displayMenu(allMenuData);
                displayAdBanner();
            } catch (error) {
                console.error('ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ:', error);
                document.getElementById('menuGrid').innerHTML = 
                    '<p class="error">ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚</p>';
            }
        }

        // ã‚«ãƒ†ã‚´ãƒªã§ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
        function filterByCategory(category, clickedButton) {
            currentCategory = category;
            
            // ãƒœã‚¿ãƒ³ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹ã‚’æ›´æ–°
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            if (clickedButton) {
                clickedButton.classList.add('active');
            }
            
            applyFilterAndSort();
        }

        // ã‚½ãƒ¼ãƒˆ
        function sortMenu(sortType) {
            currentSort = sortType;
            applyFilterAndSort();
        }

        // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã¨ã‚½ãƒ¼ãƒˆã‚’é©ç”¨
        function applyFilterAndSort() {
            let filteredData = [...allMenuData];
            
            // ã‚«ãƒ†ã‚´ãƒªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨
            if (currentCategory !== 'all') {
                filteredData = filteredData.filter(item => item.category === currentCategory);
            }
            
            // ã‚½ãƒ¼ãƒˆé©ç”¨
            switch (currentSort) {
                case 'price-asc':
                    filteredData.sort((a, b) => a.price - b.price);
                    break;
                case 'price-desc':
                    filteredData.sort((a, b) => b.price - a.price);
                    break;
                case 'popular':
                    filteredData.sort((a, b) => {
                        if (a.isPopular && !b.isPopular) return -1;
                        if (!a.isPopular && b.isPopular) return 1;
                        return 0;
                    });
                    break;
                case 'default':
                default:
                    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆé †ï¼ˆäººæ°—é † + IDé †ï¼‰
                    filteredData.sort((a, b) => {
                        if (a.isPopular && !b.isPopular) return -1;
                        if (!a.isPopular && b.isPopular) return 1;
                        return a.id - b.id;
                    });
                    break;
            }
            
            displayMenu(filteredData);
        }

        // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’ç”»é¢ã«è¡¨ç¤º
        function displayMenu(items) {
            const menuGrid = document.getElementById('menuGrid');
            menuGrid.innerHTML = '';

            if (items.length === 0) {
                menuGrid.innerHTML = '<p class="no-results">è©²å½“ã™ã‚‹ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒã‚ã‚Šã¾ã›ã‚“</p>';
                return;
            }

            items.forEach(item => {
                const card = document.createElement('div');
                card.className = 'card menu-card';
                
                // ã‚¹ãƒãƒ³ã‚µãƒ¼ãƒ‰ãƒã‚§ãƒƒã‚¯
                const sponsored = isSponsored(item.id);
                if (sponsored) {
                    card.classList.add('sponsored-card');
                }
                
                // äººæ°—ãƒãƒƒã‚¸
                const popularBadge = item.isPopular ? 
                    '<span class="popular-badge-menu">ğŸ”¥ äººæ°—</span>' : '';
                
                // ã‚¹ãƒãƒ³ã‚µãƒ¼ãƒ‰ãƒãƒƒã‚¸
                const sponsoredBadge = sponsored ? 
                    '<span class="sponsored-badge">ğŸ“¢ ã‚¹ãƒãƒ³ã‚µãƒ¼ãƒ‰</span>' : '';
                
                // ã‚«ãƒ†ã‚´ãƒªã‚¿ã‚°
                const categoryTag = `<span class="category-tag">${item.category}</span>`;
                
                card.innerHTML = `
                    <div class="card-image">
                        <img src="${item.image}" alt="${item.name}">
                        ${popularBadge}
                        ${sponsoredBadge}
                    </div>
                    <div class="card-content">
                        ${categoryTag}
                        <h3 class="card-title">${item.name}</h3>
                        <p class="card-description">${item.description}</p>
                        <div class="card-footer">
                            <span class="price">Â¥${item.price.toLocaleString()}</span>
                            <button class="btn btn-primary" onclick="selectMenu(${item.id}, '${item.name}')">
                                ã“ã®ãŠåº—ã§æ³¨æ–‡
                            </button>
                        </div>
                    </div>
                `;
                menuGrid.appendChild(card);
            });
        }

        // ãƒ¡ãƒ‹ãƒ¥ãƒ¼é¸æŠæ™‚ã®å‡¦ç†
        function selectMenu(menuId, menuName) {
            // é¸æŠæƒ…å ±ã‚’localStorageã«ä¿å­˜
            localStorage.setItem('selectedMenuId', menuId);
            localStorage.setItem('selectedMenuName', menuName);
            // é…é”å“¡é¸æŠãƒšãƒ¼ã‚¸ã¸é·ç§»
            window.location.href = 'riders.html';
        }

        // ä¼šå“¡ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¡¨ç¤º
        function displayMembershipStatus() {
            const membership = getMembershipData();
            const statusElement = document.getElementById('membershipStatus');
            
            if (membership && membership.active) {
                const planIcons = { light: 'ğŸŒŸ', standard: 'â­', premium: 'ğŸ‘‘' };
                const icon = planIcons[membership.plan] || 'ğŸ’';
                statusElement.innerHTML = `
                    <div class="member-badge ${membership.plan}">
                        ${icon} ${membership.planName}ä¼šå“¡
                    </div>
                    <a href="premium.html" class="premium-link-small">è©³ç´°</a>
                `;
            }
        }

        // ä¼šå“¡æƒ…å ±ã‚’å–å¾—
        function getMembershipData() {
            const data = localStorage.getItem('membership');
            return data ? JSON.parse(data) : null;
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’å–å¾—
        window.addEventListener('DOMContentLoaded', () => {
            loadMenu();
            displayMembershipStatus();
        });
    </script>
</body>
</html>

